---
layout: post
title: "ä»£ç "
date: 2026-02-11
---

ä»£ç 1HF
FROM node:22-slim
RUN corepack enable

# --- âš¡ 1. å¢å¼ºç‰ˆä¾èµ–å®‰è£… (åŒ…å«å…¨å¥— Python å·¥å…·) ---
RUN apt-get update && apt-get install -y \
    git procps curl wget ca-certificates ffmpeg python3 python3-pip python3-full make g++ build-essential \
    chromium libnss3 libatk1.0-0 libatk-bridge2.0-0 libcups2 libdrm2 \
    libxkbcommon0 libxcomposite1 libxdamage1 libxrandr2 libgbm1 \
    libpango-1.0-0 libasound2 libnacl-dev libsodium-dev \
    && rm -rf /var/lib/apt/lists/*

# å¼ºåˆ¶é¢„è£… Python å¸¸ç”¨æœç´¢åº“ï¼Œé¿å¼€ PEP 668 æŠ¥é”™
RUN python3 -m pip install --upgrade pip --break-system-packages
RUN python3 -m pip install duckduckgo-search --break-system-packages

WORKDIR /app

# --- ğŸŒ 2. æ ¸å¿ƒç½‘ç»œä¿é™© ---
ENV NODE_OPTIONS="--dns-result-order=ipv4first --use-openssl-ca"
ENV NODE_TLS_REJECT_UNAUTHORIZED=0
ENV UNDICI_UA="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36"
ENV CHROME_PATH=/usr/bin/chromium
ENV PUPPETEER_SKIP_CHROMIUM_DOWNLOAD=true
ENV OPENCLAW_GATEWAY_TOKEN=123456
ENV NODE_ENV=production
ENV HOME=/app

# --- ğŸ“¦ 3. æºç å…‹éš†ä¸æ·±åº¦è¡¥ä¸ ---
RUN git clone https://github.com/jiazheng107104/claw2026niu2026.git .
RUN pnpm install

# ğŸ’‰ è¡¥ä¸ï¼šä¸ä»…æ”¹åŸŸåï¼Œè¿˜é¡ºä¾¿ä¿®å¤ä»£ç é‡Œçš„ DDgs å¤§å°å†™æ‹¼å†™é”™è¯¯
RUN grep -rl "api.telegram.org" . | xargs sed -i 's/api.telegram.org/key.cntangth.online\/tgproxy/g' || true
RUN grep -rl "DDgs" . | xargs sed -i 's/DDgs/DDGS/g' || true

# ğŸ’‰ æ³¨å…¥å‰ç«¯å¯†ç é”
RUN sed -i '/<head>/a <script>(function(){if(localStorage.getItem("isClawUnlocked")==="true")return;const pwd=prompt("è¯·è¾“å…¥è®¿é—®æˆæƒå¯†ç ï¼š");if(!pwd){alert("å¿…é¡»è¾“å…¥å¯†ç æ‰èƒ½è®¿é—®ï¼");window.location.reload();return}fetch(`https://key.cntangth.online/verify.php?password=${encodeURIComponent(pwd)}`).then(r=>r.json()).then(d=>{if(d.status==="ok"){localStorage.setItem("isClawUnlocked","true");alert("è§£é”æˆåŠŸï¼")}else{alert("å¯†ç é”™è¯¯ï¼");window.location.reload()}}).catch(e=>{alert("é‰´æƒå¤±è´¥:"+e);window.location.reload()})})()</script>' ui/index.html || true

RUN pnpm run build

# --- ğŸ’¾ 4. å†™å…¥é…ç½® (ä¿æŒä¸å˜) ---
RUN mkdir -p /app/.openclaw/workspace
RUN touch /app/.openclaw/workspace/MEMORY.md
RUN printf '{\n\
  "meta": { "lastTouchedVersion": "2026.2.4" },\n\
  "gateway": { "auth": { "mode": "token", "token": "123456" } },\n\
  "commands": { "restart": true },\n\
  "browser": {\n\
    "enabled": true,\n\
    "defaultProfile": "openclaw",\n\
    "executablePath": "/usr/bin/chromium",\n\
    "noSandbox": true\n\
  },\n\
  "channels": {\n\
    "telegram": {\n\
      "enabled": true,\n\
      "botToken": "7895663759:AAF_iRhzyTXXxUDybDt0QUkX1U34AatAtR4",\n\
      "dmPolicy": "open",\n\
      "allowFrom": ["*"]\n\
    }\n\
  },\n\
  "agents": {\n\
    "defaults": {\n\
      "model": { "primary": "openai/moonshotai/kimi-k2.5" },\n\
      "sandbox": {\n\
        "browser": { "enabled": true }\n\
      }\n\
    }\n\
  },\n\
  "models": {\n\
    "providers": {\n\
      "openai": {\n\
        "api": "openai-completions",\n\
        "apiKey": "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",\n\
        "auth": "api-key",\n\
        "baseUrl": "https://integrate.api.nvidia.com/v1",\n\
        "authHeader": true,\n\
        "models": [\n\
          { "id": "moonshotai/kimi-k2.5", "name": "kimi-k2.5", "contextWindow": 64000 }\n\
        ]\n\
      }\n\
    }\n\
  }\n\
}' > /app/.openclaw/openclaw.json

# --- ğŸ”Œ 5. æ³¨å…¥æŠ€èƒ½åº“ ---
RUN git clone https://github.com/VoltAgent/awesome-openclaw-skills.git /tmp/awesome-skills && \
    mkdir -p /app/skills && \
    cp -r /tmp/awesome-skills/[!.]* /app/skills/ || true && \
    rm -rf /tmp/awesome-skills

# --- ğŸ›¡ï¸ 6. è®¾ç½®æƒé™å¹¶å¯åŠ¨ ---
RUN chown -R 1000:1000 /app
USER 1000
EXPOSE 7860
ENV PATH="/app:$PATH"
CMD ["node", "scripts/run-node.mjs", "--", "gateway"]

### å›¾ç‰‡
![æè¿°](å›¾ç‰‡é“¾æ¥)
